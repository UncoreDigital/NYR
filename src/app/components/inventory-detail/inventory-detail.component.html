<div class="page-layout">
    <app-sidebar></app-sidebar>
    <div class="main-content">
        <app-header></app-header>
        <div class="content">

            <!-- Breadcrumb -->
            <div class="breadcrumb">
                <ng-container *ngFor="let item of breadcrumbItems; let last = last">
                    <a *ngIf="item.route" 
                       [routerLink]="item.route" 
                       class="breadcrumb-item active hover:text-blue-600 cursor-pointer">
                        {{item.label}}
                    </a>
                    <span *ngIf="!item.route" class="breadcrumb-item active">
                        {{item.label}}
                    </span>
                    <mat-icon *ngIf="!last" class="breadcrumb-separator active">chevron_right</mat-icon>
                </ng-container>
            </div>

            <!-- Page Header -->
            <div class="page-header">
                <h1>{{sourceTitle}}</h1>
            </div>

            <!-- Search Bar -->
            <div class="search-section">
                <div class="search-container">
                    <mat-icon class="search-icon">search</mat-icon>
                    <input type="text" placeholder="Search..." class="search-input" (keyup)="applyFilter($event)">
                </div>
                <button class="btn btn-primary" (click)="transferToVan()">
                    {{ sourceContext === 'location' ? 'Request Inventory' : 'Transfer Inventory' }}
                </button>
            </div>

            <!-- Loading Spinner -->
            <div *ngIf="loading" class="loading-container">
                <mat-spinner diameter="50"></mat-spinner>
                <p>Loading inventory...</p>
            </div>

            <!-- Table -->
            <div class="table-container" *ngIf="!loading">
                <table class="customer-table">
                    <thead>
                        <tr>
                            <th (click)="onSortChange('productName')" class="sortable">
                                PRODUCT NAME
                                <mat-icon *ngIf="sortBy === 'productName'">
                                    {{sortOrder === 'asc' ? 'arrow_upward' : 'arrow_downward'}}
                                </mat-icon>
                            </th>
                            <th (click)="onSortChange('skucode')" class="sortable">
                                SKU/CODE
                                <mat-icon *ngIf="sortBy === 'skucode'">
                                    {{sortOrder === 'asc' ? 'arrow_upward' : 'arrow_downward'}}
                                </mat-icon>
                            </th>
                            <th (click)="onSortChange('variantName')" class="sortable">
                                VARIANT
                                <mat-icon *ngIf="sortBy === 'variantName'">
                                    {{sortOrder === 'asc' ? 'arrow_upward' : 'arrow_downward'}}
                                </mat-icon>
                            </th>
                            <th (click)="onSortChange('quantity')" class="sortable">
                                QUANTITY
                                <mat-icon *ngIf="sortBy === 'quantity'">
                                    {{sortOrder === 'asc' ? 'arrow_upward' : 'arrow_downward'}}
                                </mat-icon>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let detail of inventoryLocation">
                            <td>{{detail.productName}}</td>
                            <td>{{detail.skucode}}</td>
                            <td>{{detail.variantName}}</td>
                            <td>{{detail.quantity}}</td>
                        </tr>
                    </tbody>
                </table>

                <mat-paginator 
                    [length]="totalCount"
                    [pageIndex]="pageIndex"
                    [pageSize]="pageSize"
                    [pageSizeOptions]="pageSizeOptions" 
                    showFirstLastButtons 
                    class="table-paginator"
                    (page)="onPageChange($event)">
                </mat-paginator>
            </div>
        </div>
    </div>
</div>
