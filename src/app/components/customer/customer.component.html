<div class="page-layout">
  <app-sidebar></app-sidebar>
  <div class="main-content">
    <app-header></app-header>
    <div class="content">
      <!-- Breadcrumb -->
      <div class="breadcrumb">
        <!-- <span class="breadcrumb-item active">Settings</span>
        <mat-icon class="breadcrumb-separator active">chevron_right</mat-icon> -->
        <span class="breadcrumb-item active">Customer</span>
      </div>
      
      <!-- Page Header -->
      <div class="page-header">
        <h1>Customer</h1>
        
      </div>
      
      <!-- Search Bar -->
      <div class="search-section">
        <div class="search-container">
          <mat-icon class="search-icon">search</mat-icon>
          <input 
            type="text" 
            placeholder="Search..." 
            class="search-input"
            (keyup)="applyFilter($event)">
        </div>
        <button class="btn btn-primary" (click)="addCustomer()">
          Add Customer
        </button>
      </div>
      
      <!-- Loading State -->
      <ng-container *ngIf="isLoading; else contentTemplate">
        <div class="loading-container">
          <div class="loading-spinner"></div>
          <p>Loading customers...</p>
        </div>
      </ng-container>

      <ng-template #contentTemplate>
        <!-- Customer Table -->
        <div class="table-container" *ngIf="customers.length > 0; else emptyTemplate">
          <table class="customer-table">
            <thead>
              <tr>
                <th (click)="onSortChange('companyName')" class="sortable">
                  COMPANY NAME
                  <mat-icon *ngIf="sortBy === 'companyName'">
                    {{sortOrder === 'asc' ? 'arrow_upward' : 'arrow_downward'}}
                  </mat-icon>
                </th>
                <th (click)="onSortChange('contactName')" class="sortable">
                  CONTACT NAME
                  <mat-icon *ngIf="sortBy === 'contactName'">
                    {{sortOrder === 'asc' ? 'arrow_upward' : 'arrow_downward'}}
                  </mat-icon>
                </th>
                <th (click)="onSortChange('address')" class="sortable">
                  ADDRESS
                  <mat-icon *ngIf="sortBy === 'address'">
                    {{sortOrder === 'asc' ? 'arrow_upward' : 'arrow_downward'}}
                  </mat-icon>
                </th>
                <th (click)="onSortChange('phoneNumber')" class="sortable">
                  PHONE NUMBER
                  <mat-icon *ngIf="sortBy === 'phoneNumber'">
                    {{sortOrder === 'asc' ? 'arrow_upward' : 'arrow_downward'}}
                  </mat-icon>
                </th>
                <th>ACTION</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let customer of customers">
                <td>{{customer.companyName}}</td>
                <td>{{customer.contactName}}</td>
                <td>{{customer.address}}</td>
                <td>{{customer.phoneNumber}}</td>
                <td>
                  <div class="action-group">
                    <button class="group-btn edit" (click)="editCustomer(customer)" title="Edit">
                      <mat-icon>edit</mat-icon>
                    </button>
                    <span class="group-divider"></span>
                    <button class="group-btn delete" (click)="deleteCustomer(customer)" title="Delete">
                      <mat-icon>delete</mat-icon>
                    </button>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>

          <!-- Paginator -->
          <mat-paginator 
            *ngIf="!isLoading"
            [length]="totalCount"
            [pageIndex]="pageIndex"
            [pageSize]="pageSize"
            [pageSizeOptions]="pageSizeOptions" 
            showFirstLastButtons
            class="table-paginator"
            (page)="onPageChange($event)">
          </mat-paginator>
        </div>

        <ng-template #emptyTemplate>
          <div class="loading-container">
            <p>No customers found.</p>
          </div>
        </ng-template>
      </ng-template>
    </div>
  </div>
</div>

<!-- Credit Card Information Modal -->
<div class="modal-overlay" *ngIf="showCreditCardModal" (click)="closeCreditCardModal()">
  <div class="modal-container" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>Credit Card Information</h2>
      <button class="close-btn" (click)="closeCreditCardModal()">
        <mat-icon>close</mat-icon>
      </button>
    </div>
    <div class="modal-content">
      <form class="credit-card-form">
        <div class="form-row">
          <div class="form-group">
            <label>Card Company Name</label>
            <input type="text" class="form-input" placeholder="Enter Card Company Name" [(ngModel)]="creditCardData.cardCompanyName" name="cardCompanyName">
          </div>
          <div class="form-group">
            <label>Name on the card</label>
            <input type="text" class="form-input" placeholder="Enter Name on the card" [(ngModel)]="creditCardData.nameOnCard" name="nameOnCard">
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Credit Card Number</label>
            <input type="text" class="form-input" placeholder="Enter Credit Card Number" [(ngModel)]="creditCardData.cardNumber" name="cardNumber">
          </div>
          <div class="form-group">
            <label>Credit Card Type</label>
            <input type="text" class="form-input" placeholder="Enter Credit Card Type" [(ngModel)]="creditCardData.cardType" name="cardType">
          </div>
        </div>
        <div class="form-row">
          <div class="form-group mb-0">
            <label>Security Code</label>
            <input type="text" class="form-input" placeholder="Enter Security Code" [(ngModel)]="creditCardData.securityCode" name="securityCode">
          </div>
          <div class="form-group mb-0">
            <label>Expiration Date</label>
            <input type="text" class="form-input" placeholder="Enter Expiration Date" [(ngModel)]="creditCardData.expirationDate" name="expirationDate">
          </div>
        </div>
        <hr class="form-divider">
        <div class="form-row">
          <div class="form-group">
            <label>Bank Name</label>
            <input type="text" class="form-input" placeholder="Enter Bank Name" [(ngModel)]="creditCardData.bankName" name="bankName">
          </div>
          <div class="form-group">
            <label>Bank Phone</label>
            <input type="text" class="form-input" placeholder="Enter Bank Phone" [(ngModel)]="creditCardData.bankPhone" name="bankPhone">
          </div>
        </div>
        <div class="form-row">
          <div class="form-group full-width">
            <label>Address</label>
            <input type="text" class="form-input" placeholder="Enter address" [(ngModel)]="creditCardData.address" name="address">
          </div>
        </div>
        <div class="form-row">
          <div class="form-group mb-0">
            <label>City</label>
            <input type="text" class="form-input" placeholder="Enter City" [(ngModel)]="creditCardData.city" name="city">
          </div>
          <div class="form-group mb-0">
            <label>State</label>
            <input type="text" class="form-input" placeholder="Enter State" [(ngModel)]="creditCardData.state" name="state">
          </div>
          <div class="form-group mb-0">
            <label>Zip Code</label>
            <input type="text" class="form-input" placeholder="Enter Zip Code" [(ngModel)]="creditCardData.zipCode" name="zipCode">
          </div>
        </div>
        <hr class="form-divider">
        <div class="form-row">
          <div class="form-group">
            <label>Account Type</label>
            <input type="text" class="form-input" placeholder="Enter Account Type" [(ngModel)]="creditCardData.accountType" name="accountType">
          </div>
          <div class="form-group">
            <label>Bank Rep Name</label>
            <input type="text" class="form-input" placeholder="Enter Bank Rep Name" [(ngModel)]="creditCardData.bankRepName" name="bankRepName">
          </div>
          <div class="form-group">
            <label>Account Number</label>
            <input type="text" class="form-input" placeholder="Enter Account Number" [(ngModel)]="creditCardData.accountNumber" name="accountNumber">
          </div>
        </div>
        <div class="form-row">
          <div class="form-group full-width">
            <label>Customer Since</label>
            <input type="text" class="form-input" placeholder="Enter Customer Since" [(ngModel)]="creditCardData.customerSince" name="customerSince">
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Balance</label>
            <input type="text" class="form-input" placeholder="Enter balance" [(ngModel)]="creditCardData.balance" name="balance">
          </div>
          <div class="form-group">
            <label>Credit Limit</label>
            <input type="text" class="form-input" placeholder="Enter Credit Limit" [(ngModel)]="creditCardData.creditLimit" name="creditLimit">
          </div>
        </div>
      </form>
    </div>
    <div class="modal-footer">
      <button class="btn btn-primary" (click)="saveCreditCardInfo()">Save</button>
      <button class="btn btn-secondary" (click)="closeCreditCardModal()">Cancel</button>
    </div>
  </div>
</div>