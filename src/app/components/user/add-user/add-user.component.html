<div class="page-layout">
    <app-sidebar></app-sidebar>
    <div class="main-content">
        <app-header></app-header>
        <div class="content">

            <!-- Breadcrumb -->
            <div class="breadcrumb flex items-center space-x-2 text-gray-600">
                <a class="breadcrumb-item hover:text-blue-600 cursor-pointer active">
                    Settings
                </a>
                <mat-icon class="breadcrumb-separator text-gray-400">chevron_right</mat-icon>

                <a routerLink="/users" class="breadcrumb-item hover:text-blue-600 cursor-pointer active">
                    User
                </a>
                <mat-icon class="breadcrumb-separator text-gray-400">chevron_right</mat-icon>

                <span class="breadcrumb-item text-gray-800 font-semibold active">
                    Add User
                </span>
            </div>


            <!-- Page Header -->
            <div class="page-header">
                <h1>Add User</h1>

            </div>

            <div class="table-container">
                <form [formGroup]="userForm" class="user-form" (ngSubmit)="onSubmit()">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Select Role</label>
                            <select formControlName="role" class="form-control">
                                <option value="" disabled selected>Select a role</option>
                                <option value="admin">Administrators</option>
                                <option value="warehouse">Warehouse and Inventory</option>
                                <option value="driver">Drivers</option>
                                <option value="location">Location Staff</option>
                            </select>
                        </div>
                        <div class="form-group"
                            *ngIf="userForm.get('role')?.value === '' || userForm.get('role')?.value === 'admin' || userForm.get('role')?.value === 'location'">
                            <label>Customer</label>
                            <select formControlName="customer" class="form-control">
                                <option value="" disabled selected>Select a Customer</option>
                                <option value="customer">Customer 1</option>
                            </select>
                        </div>
                        <div class="form-group"
                            *ngIf="userForm.get('role')?.value === '' || userForm.get('role')?.value === 'admin' || userForm.get('role')?.value === 'location'">
                            <label>Select Location</label>
                            <select formControlName="locationName" class="form-control">
                                <option value="" disabled selected>Select a Location</option>
                                <option value="customer">Location 1</option>
                            </select>
                        </div>
                        <div class="form-group" *ngIf="userForm.get('role')?.value === 'driver'">
                            <label>&nbsp;</label>
                            <button type="button" class="btn btn-primary" style="width: fit-content;" (click)="driverAvailabilityClick()">Manage Driver
                                Availability</button>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Name</label>
                            <input formControlName="name" type="text" placeholder="Enter Name" />
                        </div>
                        <div class="form-group">
                            <label>Email Address</label>
                            <input formControlName="email" type="text" placeholder="Enter Email Address" />
                        </div>
                        <div class="form-group">
                            <label>Phone Number</label>
                            <input formControlName="phoneNumber" type="text" placeholder="Enter Phone Number" />
                        </div>
                    </div>
                    <div class="form-row" *ngIf="userForm.get('role')?.value === 'driver'">
                        <div class="form-group">
                            <label>Home Address</label>
                            <input formControlName="name" type="text" placeholder="Enter Home Address" />
                        </div>
                        <div class="form-group">
                            <label>Default Starting Point</label>
                            <input formControlName="startingPoint" type="text"
                                placeholder="Enter Default Starting Point" />
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">Save</button>
                        <button type="reset" class="btn btn-outline">Cancel</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<div class="modal-backdrop" id="driverAvailability" *ngIf="driverAvailability">
    <div class="modal-success">
        <h2 style="text-align:center; font-size:1.2rem; font-weight:600; margin-bottom:24px;">Manage Driver availability
        </h2>
        <div class="availability-days" style="display:flex; gap:18px; justify-content:center; margin-bottom:24px;">
            <label *ngFor="let day of days" style="display:flex; align-items:center; gap:6px; font-size:0.9rem;">
                <input type="checkbox" [(ngModel)]="driverDays[day]" />
                {{ day }}
            </label>
        </div>
        <div class="availability-times" style="display:flex; gap:24px; justify-content:center; margin-bottom:32px;">
            <div style="flex:1;">
                <label style="font-weight:400; display:block; margin-bottom:8px; text-align: left;">Start Time</label>
                <div style="position:relative;">
                    <input type="time" [(ngModel)]="startTime" placeholder="Select Time" />
                    <mat-icon
                        style="position:absolute; right:10px; top:50%; transform:translateY(-50%); color:#bdbdbd;">schedule</mat-icon>
                </div>
            </div>
            <div style="flex:1;">
                <label style="font-weight:400; display:block; margin-bottom:8px; text-align: left;">End Time</label>
                <div style="position:relative;">
                    <input type="time" [(ngModel)]="endTime" placeholder="Select Time" />
                    <mat-icon
                        style="position:absolute; right:10px; top:50%; transform:translateY(-50%); color:#bdbdbd;">schedule</mat-icon>
                </div>
            </div>
        </div>
        <div style="display:flex; gap:18px; justify-content:center;">
            <button class="btn btn-primary" (click)="saveDriverAvailability()">Done</button>
            <button class="btn btn-outline" (click)="closeDriverAvailability()">Cancel</button>
        </div>
    </div>
</div>
<div class="modal-backdrop" *ngIf="showSuccess">
    <div class="modal-success">
        <div class="modal-icon">
            <mat-icon>check_circle</mat-icon>
        </div>
        <div class="modal-message">
            <h2>User has been successfully added.</h2>
        </div>
        <div class="modal-actions">
            <button class="btn btn-primary" (click)="addAnotherUser()">Add Another User</button>
            <button class="btn btn-outline" (click)="goToUsersList()">Go to Users List</button>
        </div>
    </div>
</div>